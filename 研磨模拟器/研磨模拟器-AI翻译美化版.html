<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>磨炼模拟器</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Roboto', Arial, sans-serif;
            background-color: #f4f4f9;
            color: #333;
        }
        #content {
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            text-align: center;
            background-color: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }
        h1 {
            font-size: 2em;
            color: #4a90e2;
            margin-bottom: 20px;
        }
        p {
            font-size: 1.2em;
            line-height: 1.5;
        }
        button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 16px;
            color: #fff;
            background-color: #4a90e2;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #357ABD;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        #resetBtn {
            background-color: #e74c3c;
        }
        #resetBtn:hover {
            background-color: #c0392b;
        }
        #materials, #totalUsed, #highestStage {
            background-color: #f9f9f9;
            padding: 10px;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        #result {
            margin-top: 20px;
            font-size: 1.5em;
            color: #e67e22;
        }
    </style>
</head>
<body>
    <div id="content">
        <h1>磨炼模拟器</h1>
        <p id="stage">当前磨炼数值: 0</p>
        <p id="probabilities">概率 - 成功: 45%, 维持: 55%, 失败: 0%, 破坏: 0%</p>
        <p id="materials">
            催化剂: 2<br>
            高级莱恩矿石: 3<br>
            金币: 6,200,000 金币
        </p>
        <button id="enhanceBtn">磨炼</button>
        <button id="autoEnhanceBtn">自动磨炼</button>
        <button id="cheatBtn">作弊</button>
        <p id="result"></p>
        <p id="totalUsed">
            到目前为止消耗的催化剂: 0<br>
            到目前为止消耗的高级莱恩矿石: 0<br>
            到目前为止消耗的金币: 0
        </p>
        <p id="highestStage">到目前为止成功的最高磨炼阶段: 0</p>
        <button id="resetBtn" style="display: none;">重置</button>
    </div>

    <script>
        const stages = [
            { success: 45, maintain: 55, fail: 0, destroy: 0, catalysts: 2, sangrako: 3, gold: 6200000 },
            { success: 30, maintain: 40, fail: 30, destroy: 0, catalysts: 2, sangrako: 3, gold: 7502000 },
            { success: 22, maintain: 46, fail: 30, destroy: 2, catalysts: 2, sangrako: 4, gold: 8900700 },
            { success: 20, maintain: 45, fail: 30, destroy: 5, catalysts: 3, sangrako: 4, gold: 10427000 },
            { success: 17, maintain: 44, fail: 30, destroy: 9, catalysts: 3, sangrako: 5, gold: 12254000 },
            { success: 15, maintain: 42, fail: 30, destroy: 13, catalysts: 3, sangrako: 5, gold: 13979000 },
            { success: 13, maintain: 44, fail: 30, destroy: 17, catalysts: 4, sangrako: 6, gold: 15806000 },
            { success: 11, maintain: 46, fail: 30, destroy: 21, catalysts: 4, sangrako: 6, gold: 17781000 },
            { success: 9, maintain: 48, fail: 30, destroy: 25, catalysts: 4, sangrako: 7, gold: 19881000 },
            { success: 7, maintain: 50, fail: 30, destroy: 29, catalysts: 5, sangrako: 7, gold: 22136000 }
        ];

        let currentStage = 0;
        let highestStage = 0;
        let totalCatalystsUsed = 0;
        let totalSangrakoUsed = 0;
        let totalGoldUsed = 0;
        let autoEnhancing = false;
        let cheatMode = false; // 作弊模式标志
        let autoEnhanceInterval;

        const stageElement = document.getElementById('stage');
        const probabilitiesElement = document.getElementById('probabilities');
        const materialsElement = document.getElementById('materials');
        const resultElement = document.getElementById('result');
        const totalUsedElement = document.getElementById('totalUsed');
        const highestStageElement = document.getElementById('highestStage');
        const enhanceBtn = document.getElementById('enhanceBtn');
        const autoEnhanceBtn = document.getElementById('autoEnhanceBtn');
        const cheatBtn = document.getElementById('cheatBtn');
        const resetBtn = document.getElementById('resetBtn');

        function updateUI() {
            const stageData = stages[currentStage];
            stageElement.innerText = `当前磨炼数值: ${currentStage}`;
            probabilitiesElement.innerText = `概率 - 成功: ${stageData.success}%, 维持: ${stageData.maintain}%, 失败: ${stageData.fail}%, 破坏: ${stageData.destroy}%`;
            materialsElement.innerHTML = `催化剂: ${stageData.catalysts}<br>高级莱恩矿石: ${stageData.sangrako}<br>金币: ${stageData.gold.toLocaleString()} 金币`;
            totalUsedElement.innerHTML = `到目前为止消耗的催化剂: ${totalCatalystsUsed.toLocaleString()}<br>到目前为止消耗的高级莱恩矿石: ${totalSangrakoUsed.toLocaleString()}<br>到目前为止消耗的金币: ${totalGoldUsed.toLocaleString()}`;
            highestStageElement.innerText = `到目前为止成功的最高磨炼阶段: ${highestStage}`;
        }

        function enhance() {
            if (currentStage >= 10) return;

            const stageData = stages[currentStage];

            totalCatalystsUsed += stageData.catalysts;
            totalSangrakoUsed += stageData.sangrako;
            totalGoldUsed += stageData.gold;

            if (cheatMode) {
                // 如果作弊模式开启，则强制成功
                currentStage++;
                cheatMode = false; // 作弊模式在使用一次后关闭
                resultElement.innerText = '作弊成功! 磨炼阶段上升。';
            } else {
                const random = Math.random() * 100;

                if (random < stageData.success) {
                    currentStage++;
                    resultElement.innerText = '成功! 阶段上升。';
                } else if (random < stageData.success + stageData.maintain) {
                    resultElement.innerText = '维持!';
                } else if (random < stageData.success + stageData.maintain + stageData.fail) {
                    currentStage--;
                    resultElement.innerText = '失败!';
                } else {
                    currentStage = 0;
                    resultElement.innerText = '磨炼破坏!';
                }
            }

            if (currentStage > highestStage) {
                highestStage = currentStage;
            }

            updateUI();

            if (currentStage >= 10) {
                autoEnhancing = false;
                clearInterval(autoEnhanceInterval);
                resultElement.innerText = '恭喜你达到了最高阶段！';
                enhanceBtn.disabled = true;
                autoEnhanceBtn.disabled = true;
                cheatBtn.disabled = true;
                resetBtn.style.display = 'inline-block';
            }
        }

        enhanceBtn.addEventListener('click', enhance);

        autoEnhanceBtn.addEventListener('click', function() {
            if (autoEnhancing) {
                autoEnhancing = false;
                clearInterval(autoEnhanceInterval);
                autoEnhanceBtn.innerText = '自动磨炼';
                resultElement.innerText = '自动磨炼已停止。';
            } else {
                autoEnhancing = true;
                autoEnhanceBtn.innerText = '停止自动磨炼';
                function autoEnhance() {
                    if (autoEnhancing && currentStage < 10) {
                        enhance();
                        setTimeout(autoEnhance, 500); // 每0.5秒自动磨炼一次
                    }
                }
                autoEnhanceInterval = setInterval(autoEnhance, 500); // 设置定时器
            }
        });

        cheatBtn.addEventListener('click', function() {
            cheatMode = true;
            resultElement.innerText = '作弊模式已激活: 下一次磨炼必定成功!';
        });

        resetBtn.addEventListener('click', function() {
            currentStage = 0;
            highestStage = 0;
            totalCatalystsUsed = 0;
            totalSangrakoUsed = 0;
            totalGoldUsed = 0;
            autoEnhancing = false;
            enhanceBtn.disabled = false;
            autoEnhanceBtn.disabled = false;
            cheatBtn.disabled = false;
            resultElement.innerText = '';
            resetBtn.style.display = 'none';
            updateUI();
        });

        updateUI();
    </script>
</body>
</html>
